<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Impact du tronc commun et de la ségrégation scolaire</title>
    
    <!-- React et ReactDOM -->
    <script src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
    
    <!-- Dependencies -->
    <script src="https://unpkg.com/prop-types@15.7.2/prop-types.min.js"></script>
    <script src="https://unpkg.com/d3-scale@3.2.3/dist/d3-scale.min.js"></script>
    <script src="https://unpkg.com/d3-shape@2.0.0/dist/d3-shape.min.js"></script>
    <script src="https://unpkg.com/d3-array@2.8.0/dist/d3-array.min.js"></script>
    
    <!-- Recharts -->
    <script src="https://unpkg.com/recharts@2.1.2/umd/Recharts.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { LineChart, Line, XAxis, YAxis, Tooltip, Legend, ResponsiveContainer } = Recharts;

        const TrackingEffect = () => {
            const [segregationLevel, setSegregationLevel] = React.useState(30);

            const data = React.useMemo(() => {
                const result = [];
                const segregationImpact = segregationLevel / 100;

                for (let years = 4; years <= 12; years++) {
                    const trackingEffect = (years - 4) * 2;
                    result.push({
                        annees: years,
                        'Élèves favorisés': Math.round(540 - (segregationImpact * 10) + (trackingEffect * 0.5)),
                        'Élèves moyens': Math.round(500 + (trackingEffect * 1.0) - (segregationImpact * 15)),
                        'Élèves défavorisés': Math.round(460 + (trackingEffect * 1.5) - (segregationImpact * 20)),
                        'Dispersion': Math.round(Math.max(20, 40 + (segregationImpact * 40) - (trackingEffect * 1.5)))
                    });
                }
                return result;
            }, [segregationLevel]);

            return (
                <div className="max-w-4xl mx-auto p-4">
                    <h1 className="text-2xl mb-4">Effet du tronc commun et de la ségrégation scolaire</h1>
                    
                    <div className="mb-6">
                        <label className="block mb-2">
                            Niveau de ségrégation : {segregationLevel}%
                        </label>
                        <input
                            type="range"
                            min="0"
                            max="100"
                            value={segregationLevel}
                            onChange={e => setSegregationLevel(Number(e.target.value))}
                            className="w-full"
                        />
                    </div>

                    <div style={{ width: '100%', height: 400 }} className="mb-8">
                        <ResponsiveContainer>
                            <LineChart data={data}>
                                <XAxis dataKey="annees" />
                                <YAxis domain={[400, 600]} />
                                <Tooltip />
                                <Legend />
                                <Line type="monotone" dataKey="Élèves favorisés" stroke="#2563eb" />
                                <Line type="monotone" dataKey="Élèves moyens" stroke="#059669" />
                                <Line type="monotone" dataKey="Élèves défavorisés" stroke="#dc2626" />
                            </LineChart>
                        </ResponsiveContainer>
                    </div>

                    <div style={{ width: '100%', height: 400 }}>
                        <ResponsiveContainer>
                            <LineChart data={data}>
                                <XAxis dataKey="annees" />
                                <YAxis domain={[0, 100]} />
                                <Tooltip />
                                <Legend />
                                <Line type="monotone" dataKey="Dispersion" stroke="#6b7280" />
                            </LineChart>
                        </ResponsiveContainer>
                    </div>
                </div>
            );
        };

        ReactDOM.render(
            <TrackingEffect />,
            document.getElementById('root')
        );
    </script>
</body>
</html>